<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tudor Popescu\Desktop\I.NET\Project\VetExpert\VetExpert\VetExpert.Application\Handlers\Bills\UpdateBillCommandHandler.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using AutoMapper;
using MediatR;
using VetExpert.Application.Commands.Bills;
using VetExpert.Application.Response.Bills;
using VetExpert.Domain;
using VetExpert.Infrastructure;

namespace VetExpert.Application.Handlers.Bills
{
	public class UpdateBillCommandHandler : IRequestHandler&lt;UpdateBillCommand, BillResponse&gt;
	{
		private readonly IRepository&lt;Bill&gt; _repository;
		private readonly IMapper _mapper;

		public UpdateBillCommandHandler(IRepository&lt;Bill&gt; repository, IMapper mapper)
		{
			_repository = repository;
			_mapper = mapper;
		}
		public async Task&lt;BillResponse&gt; Handle(UpdateBillCommand request, CancellationToken cancellationToken)
		{
			var bill = await _repository.Get(request.BillId);

			if (bill == null)
			{
				throw new Exception($&quot;Could not find bill with id {request.BillId}&quot;);
			}

			bill.Value = request.Value;
			bill.Currency = request.Currency;
			bill.DateTime = request.DateTime;

			_repository.Update(bill);
			await _repository.SaveChangesAsync();

			return _mapper.Map&lt;BillResponse&gt;(bill);
		}
	}
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[15,3,15,80,0],[16,3,16,4,0],[17,4,17,29,0],[18,4,18,21,0],[19,3,19,4,0],[21,3,21,4,0],[22,4,22,53,0],[24,4,24,21,0],[25,4,25,5,0],[26,5,26,74,0],[29,4,29,31,0],[30,4,30,37,0],[31,4,31,37,0],[33,4,33,29,0],[34,4,34,41,0],[36,4,36,43,0],[37,3,37,4,0]]);
    </script>
  </body>
</html>