<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\Users\Tudor Popescu\Desktop\I.NET\Project\VetExpert\VetExpert\VetExpert.IntegrationTesting\DrugStocksControllerTests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using FluentAssertions;
using Newtonsoft.Json;
using System.Net.Http.Json;
using VetExpert.API.Dto;
using Xunit;

namespace VetExpert.IntegrationTesting
{
    [Collection(&quot;Database tests&quot;)]
    public class DrugStocksControllerTests : IDisposable
    {
        private const string ApiURL = &quot;/api/drugstocks&quot;;

        [Fact]
        public async void When_CreatedDrugStock_Then_ShouldReturnDrugStockInTheGetRequest()
        {
            var http_client = new CustomWebApplicationFactory&lt;Program&gt;().CreateClient();
            CreateDrugStockDto drugStockDto = CreateSUT();
            // Act
           // var createDrugStockResponse = await http_client.PostAsJsonAsync(ApiURL, drugStockDto);
            var getDrugStockResult = await http_client.GetStringAsync(ApiURL);
            // Assert
            

            //object value = getDrugStockResult.EnsureSuccessStatusCode();

                  /*var drugs = await getDrugResult.Content
                      .ReadFromJsonAsync&lt;List&lt;CreateDrugDto&gt;&gt;();*/
            var drugStocks = JsonConvert.DeserializeObject&lt;List&lt;CreateDrugStockDto&gt;&gt;(getDrugStockResult);

            drugStocks.Count.Should().Be(0);
            drugStocks.Should().HaveCount(0);
            drugStocks.Should().NotBeNull();
            
           
            
        }

        private static CreateDrugStockDto CreateSUT()
        {
            // Arrange
            return new CreateDrugStockDto
            {
                DrugId= Guid.NewGuid(),
                Quantity = 12,
                ExpirationDate = new DateTime(2023, 1, 23)
            };
        }

        public void Dispose()
        {
           // CleanDatabases();
        }
    }
}

    </pre>
    <script type="text/javascript">
      highlightRanges([[16,9,16,10,1],[17,13,17,89,1],[18,13,18,59,1],[21,13,21,79,1],[29,13,29,106,1],[31,13,31,45,1],[32,13,32,46,1],[33,13,33,45,1],[37,9,37,10,1],[40,9,40,10,1],[42,13,47,15,1],[48,9,48,10,1],[51,9,51,10,1],[53,9,53,10,1]]);
    </script>
  </body>
</html>